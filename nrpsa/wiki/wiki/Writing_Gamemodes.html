<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	
<!-- Mirrored from wiki.nexusrp.com/wiki/Writing_Gamemodes by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 27 Aug 2015 07:28:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="generator" content="MediaWiki 1.22.13" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="Nexus RP: Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="/api.php?action=rsd" />
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
<link rel="alternate" type="application/atom+xml" title="Nexus RP: Wiki Atom feed" index.html?title=Special:RecentChanges&amp;feed=atom" />		<title>Writing Gamemodes - Nexus RP: Wiki</title>
		<link rel="stylesheet" href="/load.php?debug=false&amp;lang=en&amp;modules=ext.rtlcite%7Cmediawiki.legacy.commonPrint%2Cshared&amp;only=styles&amp;skin=nrpbook&amp;*" />
<link rel="stylesheet" href="../skins/nrpbook/main11b9.css?303" media="screen" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/nrpbook/IE50Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/nrpbook/IE55Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/skins/nrpbook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/nrpbook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=nrpbook&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: nrp_wiki_1_22_13-wiki_dev_:resourceloader:filter:minify-css:7:68ffccca97fd0532df6141dcbaf256b6 */</style>

		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?303"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Writing_Gamemodes","wgTitle":"Writing Gamemodes","wgCurRevisionId":45787,"wgRevisionId":45787,"wgArticleId":3465,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Tutorials"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransforNRPble":["",""],"wgDigitTransforNRPble":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Writing_Gamemodes","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script>
		<script type="text/javascript" src="../skins/common/wikibits11b9.js?303"><!-- wikibits js --></script>
		<!-- Head Scripts -->
<script src="/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=nrpbook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Writing_Gamemodes","wgTitle":"Writing Gamemodes","wgCurRevisionId":45787,"wgRevisionId":45787,"wgArticleId":3465,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Tutorials"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransforNRPble":["",""],"wgDigitTransforNRPble":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Writing_Gamemodes","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"nrpbook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"vector-simplesearch":1,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,
"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs100":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: nrp_wiki_1_22_13-wiki_dev_:resourceloader:filter:minify-js:7:925126ceab977200cdcc48193642dea0 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script><style type="text/css">/*<![CDATA[*/
.source-lua {line-height: normal;}
.source-lua li, .source-lua pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for lua
 * CSS class: source-lua, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.lua.source-lua .de1, .lua.source-lua .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.lua.source-lua  {font-family:monospace;}
.lua.source-lua .imp {font-weight: bold; color: red;}
.lua.source-lua li, .lua.source-lua .li1 {font-weight: normal; vertical-align:top;}
.lua.source-lua .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.lua.source-lua .li2 {font-weight: bold; vertical-align:top;}
.lua.source-lua .kw1 {color: #b1b100;}
.lua.source-lua .co1 {color: #808080; font-style: italic;}
.lua.source-lua .coMULTI {color: #808080; font-style: italic;}
.lua.source-lua .es0 {color: #000099; font-weight: bold;}
.lua.source-lua .br0 {color: #66cc66;}
.lua.source-lua .sy0 {color: #66cc66;}
.lua.source-lua .st0 {color: #00A600;}
.lua.source-lua .nu0 {color: #cc66cc;}
.lua.source-lua .me0 {color: #b1b100;}
.lua.source-lua .ln-xtra, .lua.source-lua li.ln-xtra, .lua.source-lua div.ln-xtra {background-color: #ffc;}
.lua.source-lua span.xtra { display:block; }

/*]]>*/
</style>	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Writing_Gamemodes skin-nrpbook">
	<div id="globalWrapper">
		
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
			<h1 id="firstHeading" class="firstHeading">Writing Gamemodes</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Nexus RP: Wiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>		<!-- start content -->
<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>This guide tries to outline the process of how to write a proper gamemode. If you just started with scripting for NRP, you may want to check the other scripting tutorials at the <a href="Main_Page.html" title="Main Page">Main Page</a> first.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_does_.22proper_gamemode.22_mean.3F"><span class="tocnumber">2</span> <span class="toctext">What does "proper gamemode" mean?</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Map_Files"><span class="tocnumber">2.1</span> <span class="toctext">Map Files</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Example"><span class="tocnumber">2.1.1</span> <span class="toctext">Example</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Example_of_getting_the_.map_information"><span class="tocnumber">2.1.2</span> <span class="toctext">Example of getting the .map information</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Map_manager"><span class="tocnumber">3</span> <span class="toctext">Map manager</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#How_to_use_the_mapmanager"><span class="tocnumber">3.1</span> <span class="toctext">How to use the mapmanager</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Example_2"><span class="tocnumber">3.1.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#Making_maps_compatible"><span class="tocnumber">3.2</span> <span class="toctext">Making maps compatible</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#What_else_should_you_do"><span class="tocnumber">4</span> <span class="toctext">What else should you do</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Helpmanager"><span class="tocnumber">4.1</span> <span class="toctext">Helpmanager</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Scoreboard"><span class="tocnumber">4.2</span> <span class="toctext">Scoreboard</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Map_cycler"><span class="tocnumber">4.3</span> <span class="toctext">Map cycler</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>A gamemode is a resource that, once started, controls all of the gameplay. This may include telling the players what to do, spawning players, creating teams, defining what the players have to do to win or to get points and much more. Examples are Race and Deathmatch. 
</p>
<h2><span class="mw-headline" id="What_does_.22proper_gamemode.22_mean.3F">What does "proper gamemode" mean?</span></h2>
<p>To put it simply, a proper gamemode is one that makes full use of NRP's .map file system. This means that the gamemode code does not have any map-specific data hardcoded in it, like positions of players or cars. Instead, the gamemode should be able to load .map files which define these data. This way the gamemode can have multiple maps; also, people can create .map files for the gamemode with NRP's map editor, which is much more convenient than writing code.
</p><p>An obvious example of a "proper gamemode" is NRP:Race. It allows usermade maps with lots of possibilities within the .map file. To alter spawnpoints, objects etc., the user doesn't need to edit the gamemode itself.
</p>
<h3><span class="mw-headline" id="Map_Files">Map Files</span></h3>
<p>Map files are basically XML documents with a .map extension. They define an environment to play one or more specific gamemodes in. They are however not supposed to change the rules of the game - those are defined by the gamemode.
</p><p>Each element in a map corresponds to a node in the .map file. There is standard syntax for common things like spawnpoints, objects and vehicles; however, for "special", gamemode specific information, you need to invent your own syntax.
</p>
<h4><span class="mw-headline" id="Example">Example</span></h4>
<p>Let's take a Capture the Flag gamemode as an example. A map for this gamemode needs to mainly define spawnpoints and flag locations, and eventually objects and vehicles. A simplified map file could look like this:
</p>
<!-- PLAIN TEXT CODE FOR BOTS |<map> <spawnpoint id="spawnpoint1" posX="1959.5487060547" posY="-1714.4613037109" posZ="877.25219726563" rot="63.350006103516" model="0"/> <pickup id="Armor 1" posX="1911.083984375" posY="-1658.8798828125" posZ="885.40216064453" type="armor" health="50" respawn="60000"/> <flag posX="1959.5487060547" posY="-1714.4613037109" posZ="877.25219726563" team="blue" /> ... </map>|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="sy0">&lt;</span>map<span class="sy0">&gt;</span>
    <span class="sy0">&lt;</span>spawnpoint id<span class="sy0">=</span><span class="st0">&quot;spawnpoint1&quot;</span> posX<span class="sy0">=</span><span class="st0">&quot;1959.5487060547&quot;</span> posY<span class="sy0">=</span><span class="st0">&quot;-1714.4613037109&quot;</span> posZ<span class="sy0">=</span><span class="st0">&quot;877.25219726563&quot;</span> rot<span class="sy0">=</span><span class="st0">&quot;63.350006103516&quot;</span> model<span class="sy0">=</span><span class="st0">&quot;0&quot;</span><span class="sy0">/&gt;</span>
    <span class="sy0">&lt;</span><a href="Pickup.html" class="kw3"><span class="kw3">pickup</span></a> id<span class="sy0">=</span><span class="st0">&quot;Armor 1&quot;</span> posX<span class="sy0">=</span><span class="st0">&quot;1911.083984375&quot;</span> posY<span class="sy0">=</span><span class="st0">&quot;-1658.8798828125&quot;</span> posZ<span class="sy0">=</span><span class="st0">&quot;885.40216064453&quot;</span> <span class="kw1">type</span><span class="sy0">=</span><span class="st0">&quot;armor&quot;</span> health<span class="sy0">=</span><span class="st0">&quot;50&quot;</span> respawn<span class="sy0">=</span><span class="st0">&quot;60000&quot;</span><span class="sy0">/&gt;</span>
    <span class="sy0">&lt;</span>flag posX<span class="sy0">=</span><span class="st0">&quot;1959.5487060547&quot;</span> posY<span class="sy0">=</span><span class="st0">&quot;-1714.4613037109&quot;</span> posZ<span class="sy0">=</span><span class="st0">&quot;877.25219726563&quot;</span> <a href="Team.html" class="kw3"><span class="kw3">team</span></a><span class="sy0">=</span><span class="st0">&quot;blue&quot;</span> <span class="sy0">/&gt;</span>
    ...
<span class="sy0">&lt;/</span>map<span class="sy0">&gt;</span></pre></div></div>
<p>Here you can see two NRP elements - a spawnpoint and a pickup. More importantly, this .map has a custom "flag" node which defines the position and color of the flag. The spawnpoint and pickup can be handled by existing external resources, custom elements have to be processed by the gamemode.
</p><p>To summarize - we want mass mapper input as we saw in NRP:Race. Users should NOT have to touch the gamemode script itself at all.
</p>
<h4><span class="mw-headline" id="Example_of_getting_the_.map_information">Example of getting the .map information</span></h4>
<p>As mentioned above, your gamemode needs de retrieve custom elements that are defined in a map file and process them. This is quite easy as demonstrated below.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |local flagElements = getElementsByType ( "flag" ) for key, value in pairs(flagElements) do local posX = getElementData ( value, "posX" ) local posY = getElementData ( value, "posY" ) local posZ = getElementData ( value, "posZ" ) local team = getElementData ( value, "team" ) createObject ( 1337, posX, posY, posZ ) outputChatBox ( "Base for team " .. team .. " created" ) end|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="co1">-- retrieve a table with all flag elements</span>
<span class="kw1">local</span> flagElements <span class="sy0">=</span> getElementsByType <span class="br0">&#40;</span> <span class="st0">&quot;flag&quot;</span> <span class="br0">&#41;</span>
<span class="co1">-- loop through them</span>
<span class="kw1">for</span> key, value <span class="kw1">in</span> <span class="kw1">pairs</span><span class="br0">&#40;</span>flagElements<span class="br0">&#41;</span> <span class="kw1">do</span>
	<span class="co1">-- get our info</span>
	<span class="kw1">local</span> posX <span class="sy0">=</span> <a href="GetElementData.html" class="kw2"><span class="kw2">getElementData</span></a> <span class="br0">&#40;</span> value, <span class="st0">&quot;posX&quot;</span> <span class="br0">&#41;</span>
	<span class="kw1">local</span> posY <span class="sy0">=</span> <a href="GetElementData.html" class="kw2"><span class="kw2">getElementData</span></a> <span class="br0">&#40;</span> value, <span class="st0">&quot;posY&quot;</span> <span class="br0">&#41;</span>
	<span class="kw1">local</span> posZ <span class="sy0">=</span> <a href="GetElementData.html" class="kw2"><span class="kw2">getElementData</span></a> <span class="br0">&#40;</span> value, <span class="st0">&quot;posZ&quot;</span> <span class="br0">&#41;</span>
	<span class="kw1">local</span> <a href="Team.html" class="kw3"><span class="kw3">team</span></a> <span class="sy0">=</span> <a href="GetElementData.html" class="kw2"><span class="kw2">getElementData</span></a> <span class="br0">&#40;</span> value, <span class="st0">&quot;team&quot;</span> <span class="br0">&#41;</span>
	<span class="co1">-- create an object according to the flag position</span>
	<a href="CreateObject.html" class="kw2"><span class="kw2">createObject</span></a> <span class="br0">&#40;</span> <span class="nu0">1337</span>, posX, posY, posZ <span class="br0">&#41;</span>
	<span class="co1">-- output the team that we created a base for</span>
	<a href="OutputChatBox.html" class="kw6"><span class="kw6">outputChatBox</span></a> <span class="br0">&#40;</span> <span class="st0">&quot;Base for team &quot;</span> .. <a href="Team.html" class="kw3"><span class="kw3">team</span></a> .. <span class="st0">&quot; created&quot;</span> <span class="br0">&#41;</span>
<span class="kw1">end</span></pre></div></div>
<p>The <a href="GetElementsByType.html" title="GetElementsByType">getElementsByType</a> function retrieves a table of all the elements of a certain type (the type corresponds to the node name in the .map file). This works for both custom types and built-in NRP types (like "vehicle" or "player").
<a href="GetElementData.html" title="GetElementData">getElementData</a> can be used to retrieve the xml attributes set in the .map file.
In this simple example, an object is created at the flag's location and a message is outputted in the chatbox. In reality, you will of course need to do more during map loading, like in this case setting up collision shapes to detect players taking the flag.
</p><p><br />
</p>
<h2><span class="mw-headline" id="Map_manager">Map manager</span></h2>
<p>Having read the section above it should be clear that a gamemode should always consist of two parts:
</p>
<ul>
<li> The gamemode resource that always stays the same
</li>
<li> Many different maps resources that give the gamemode map-specific information
</li>
</ul>
<p>Now instead of writing a map-loader for every single gamemode, the <a href="Map_manager.html" title="Map manager" class="mw-redirect">Map manager</a> provides functions to load gamemodes and maps. Simply put, when you enter the correct command (for example 'gamemode ctf ctf-italy') it will start both resources 'ctf' and 'ctf-italy' while triggering an event (<a index.html?title=OnGamemodeMapStart&amp;action=edit&amp;redlink=1" class="new" title="OnGamemodeMapStart (page does not exist)">onGamemodeMapStart</a>) to tell the 'ctf' resource that a map was loaded. The 'ctf' resource can then access the information 'ctf-italy' contains and start spawning players etc.
</p>
<h3><span class="mw-headline" id="How_to_use_the_mapmanager">How to use the mapmanager</span></h3>
<p>To use the mapmanager service, your gamemode resource has to be tagged as such first. More specifically you'll be setting the "type" attribute of its &lt;info&gt; tag to "gamemode" inside meta.xml. Also, you can set the "name" attribute to a friendly name (like "Capture the flag") that will be shown on ASE instead of the resource name.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |<!<meta> <info type="gamemode" name="Cow catapulting 2.0"/> </meta>|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="sy0">&lt;!</span><span class="co1">-- meta.xml in &quot;cowcatapult&quot; gamemode --&gt;</span>
<span class="sy0">&lt;</span>meta<span class="sy0">&gt;</span>
    <span class="sy0">&lt;</span>info <span class="kw1">type</span><span class="sy0">=</span><span class="st0">&quot;gamemode&quot;</span> name<span class="sy0">=</span><span class="st0">&quot;Cow catapulting 2.0&quot;</span><span class="sy0">/&gt;</span>
<span class="sy0">&lt;/</span>meta<span class="sy0">&gt;</span></pre></div></div>
<p>If your gamemode is going to load custom maps, you should add handlers for
</p>
<ul>
<li> onGamemodeMapStart
</li>
<li> onGamemodeMapStop (if any unloading is necessary)
</li>
</ul>
<p>These are fired when a map for your gamemode is started or stopped, and pass the map resource as a parameter.
Within the handler function for these events you can extract all info you need from the resource's map files and configuration files.
</p>
<h4><span class="mw-headline" id="Example_2">Example</span></h4>
<!-- PLAIN TEXT CODE FOR BOTS |function startCtfMap( startedMap ) local mapRoot = getResourceRootElement( startedMap ) local flagElements = getElementsByType ( "flag" , mapRoot ) end addEventHandler("onGamemodeMapStart", getRootElement(), startCtfMap)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> startCtfMap<span class="br0">&#40;</span> startedMap <span class="br0">&#41;</span> <span class="co1">-- startedMap contains a reference to the resource of the map</span>
    <span class="kw1">local</span> mapRoot <span class="sy0">=</span> <a href="GetResourceRootElement.html" class="kw2"><span class="kw2">getResourceRootElement</span></a><span class="br0">&#40;</span> startedMap <span class="br0">&#41;</span>        <span class="co1">-- get the root node of the started map</span>
    <span class="kw1">local</span> flagElements <span class="sy0">=</span> getElementsByType <span class="br0">&#40;</span> <span class="st0">&quot;flag&quot;</span> , mapRoot <span class="br0">&#41;</span> <span class="co1">-- get all flags in the map and store them in a table</span>
    <span class="co1">-- go on loading information like in the example above</span>
    <span class="co1">-- spawn players etc.</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onGamemodeMapStart&quot;</span>, <a href="GetRootElement.html" class="kw2"><span class="kw2">getRootElement</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>, startCtfMap<span class="br0">&#41;</span></pre></div></div>
<h3><span class="mw-headline" id="Making_maps_compatible">Making maps compatible</span></h3>
<p>Maps are separate resources. This is done so no editing of the gamemode resource is ever necessary in order to create a custom map, and also allows you to pack map-specific scripts/config files with them.
</p><p>To make a map compatible with your gamemode, open its resource's meta.xml and tag it as well: the "type" attribute must be set to "map", and the "gamemodes" attribute must be a comma-separated list (no spaces) of gamemode resource names that the map works with.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |<!<meta> <info type="map" gamemodes="cowcatapult,assault,tdm"/> </meta>|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="sy0">&lt;!</span><span class="co1">--map's meta.xml--&gt;</span>
<span class="sy0">&lt;</span>meta<span class="sy0">&gt;</span>
    <span class="sy0">&lt;</span>info <span class="kw1">type</span><span class="sy0">=</span><span class="st0">&quot;map&quot;</span> gamemodes<span class="sy0">=</span><span class="st0">&quot;cowcatapult,assault,tdm&quot;</span><span class="sy0">/&gt;</span>
<span class="sy0">&lt;/</span>meta<span class="sy0">&gt;</span></pre></div></div>
<p>Once you have everything set up, admins will use these two commands to start/stop gamemodes:
/gamemode gamemodeName [mapName] (optional parameter allows picking an initial map, defaults to none)
/changemap mapName [gamemodeName] (optional parameter specifies the gamemode to start the map with, defaults to the current one)
</p><p><a href="Map_manager.html" title="Map manager" class="mw-redirect">Map manager</a> exports a few more access functions which you don't have to use, but may be useful.
</p>
<h2><span class="mw-headline" id="What_else_should_you_do">What else should you do</span></h2>
<p>There are several other resources that gamemodes should use/be compliant with.
</p>
<h3><span class="mw-headline" id="Helpmanager">Helpmanager</span></h3>
<p>The helpmanager is ought to be the standard interface for players when they need help. If you use the helpmanager to display your gamemode's help, every player that used helpmanager before (e.g. in other gamemodes) will immediately know how to get there. It also displays help for different resources running resources in one window, if necessary.
</p><p>There are basicially two ways to use the helpmanager:
</p>
<ul>
<li> Provide a simple text that explains how to use your gamemode
</li>
<li> Request a GUI element from the helpmanager that will be displayed in its own tab in the helpmanager window and lets you add any GUI elements to it. This is the recommended way for gamemodes that need to display more complex information that needs its own GUI.
</li>
</ul>
<p>Read the <a href="Resource_Helpmanager.html" title="Resource:Helpmanager">helpmanager help page</a> for details on how to do it.
</p>
<h3><span class="mw-headline" id="Scoreboard">Scoreboard</span></h3>
<p>Scoreboard displays players and teams currently ingame. You add custom columns to it to provide map specific information. For example the column 'points' in the 'ctf' gamemode could represent the player's points gained through kills or captures. As usual, see the <a href="Resource_Dxscoreboard.html" title="Resource:Dxscoreboard">scoreboard help page</a> for more information.
</p>
<h3><span class="mw-headline" id="Map_cycler">Map cycler</span></h3>
<p>The map cycler controls what gamemodes and maps are played on a server. You can specifiy for example how many times in a row a map will be played until it switches to the next. To achieve this, you need to tell the map cycler when your gamemode finished (e.g. when a round ends).
</p>
<!-- 
NewPP limit report
CPU time usage: 0.127 seconds
Real time usage: 0.127 seconds
Preprocessor visited node count: 96/1000000
Preprocessor generated node count: 156/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key nrp_wiki_1_22_13-wiki_dev_:pcache:idhash:3465-0!*!0!!en!*!* and timestamp 20150826134528
 -->
</div><div class="printfooter">
Retrieved from "<a index.html?title=Writing_Gamemodes&amp;oldid=45787">/index.php?title=Writing_Gamemodes&amp;oldid=45787</a>"</div>
		<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="Category_Tutorials.html" title="Category:Tutorials">Tutorials</a></li></ul></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="Writing_Gamemodes.html"Array>Page</a></li>
				 <li id="ca-talk" class="new"><a index.html?title=Talk:Writing_Gamemodes&amp;action=edit&amp;redlink=1"Array>Discussion</a></li>
				 <li id="ca-viewsource"><a index.html?title=Writing_Gamemodes&amp;action=edit"Array>View source</a></li>
				 <li id="ca-history"><a index.html?title=Writing_Gamemodes&amp;action=history"Array>History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a index.html?title=Special:UserLogin&amp;returnto=Writing+Gamemodes"Array></a></li>
			</ul>
		</div>
	</div>
	
	<div class="portlet" id="p-logo">
		<a style="background-image: url();" href="Main_Page.html"Array></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Home"><a href="Main_Page.html"Array>Home</a></li>
				<li id="n-How-you-can-help"><a href="How_you_can_help.html"Array>How you can help</a></li>
				<li id="n-recentchanges"><a href="Special_RecentChanges.html"Array>Recent changes</a></li>
				<li id="n-randompage"><a href="OnElementDataChange.html"Array>Random page</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-reference'>
		<h5>reference</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Client-Functions"><a href="Client_Scripting_Functions.html"Array>Client Functions</a></li>
				<li id="n-Client-Events"><a href="Client_Scripting_Events.html"Array>Client Events</a></li>
				<li id="n-Server-Functions"><a href="Server_Scripting_Functions.html"Array>Server Functions</a></li>
				<li id="n-Server-Events"><a href="Server_Scripting_Events.html"Array>Server Events</a></li>
				<li id="n-Useful-Functions"><a href="Useful_Functions.html"Array>Useful Functions</a></li>
				<li id="n-NRP-Classes"><a href="NRP_Classes.html"Array>NRP Classes</a></li>
				<li id="n-NRP-Elements"><a href="Element.html"Array>NRP Elements</a></li>
				<li id="n-Element-Tree"><a href="Element_tree.html"Array>Element Tree</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		
		<div id="searchBody" class="pBody">
			<form action="/index.php" id="searchform"><div>
				
				
				
				
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Tools</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Writing_Gamemodes.html"Array>What links here</a></li>
				<li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Writing_Gamemodes.html"Array>Related changes</a></li>
<li id="t-specialpages"><a href="Special_SpecialPages.html"Array>Special pages</a></li>
				<li id="t-print"><a index.html?title=Writing_Gamemodes&amp;printable=yes" rel="alternate"Array>Printable version</a></li>				<li id="t-permalink"><a index.html?title=Writing_Gamemodes&amp;oldid=45787"Array>Permanent link</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>In other languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-it"><a href="../wiki/IT/Scrivere_una_gamemode">Italiano</a></li>
				<li class="interwiki-ru"><a href="../wiki/RU/Writing_Gamemodes">Русский</a></li>
				<li class="interwiki-de"><a href="../wiki/DE/Gamemodes_schreiben">Deutsch</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" height="31" width="88" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://www.gnu.org/copyleft/fdl.html"><img src="../skins/common/images/gnu-fdl.png" alt="GNU Free Documentation License 1.2" width="88" height="31" /></a></div>
	<ul id="f-list">
					<li id="lastmod"> This page was last modified on 24 August 2015, at 06:49.</li>
					<li id="viewcount">This page has been accessed 45,725 times.</li>
					<li id="copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.2</a> unless otherwise noted.</li>
					<li id="privacy"><a href="Nexus_RP__Wiki_Privacy_policy.html" title="Nexus RP: Wiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="Nexus_RP__Wiki_About.html" title="Nexus RP: Wiki:About">About Nexus RP: Wiki</a></li>
					<li id="disclaimer"><a href="Nexus_RP__Wiki_General_disclaimer.html" title="Nexus RP: Wiki:General disclaimer">Disclaimers</a></li>
			</ul>
</div>
</div>
<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.cite"],null,true);
}</script>
<script src="/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=nrpbook&amp;*"></script>
<!-- Served in 0.295 secs. --></body>
<!-- Mirrored from wiki.nexusrp.com/wiki/Writing_Gamemodes by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 27 Aug 2015 07:28:26 GMT -->
</html>
