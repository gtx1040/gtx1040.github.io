<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	
<!-- Mirrored from wiki.nexusrp.com/wiki/Debugging by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 27 Aug 2015 07:28:25 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="generator" content="MediaWiki 1.22.13" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="Nexus RP: Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="/api.php?action=rsd" />
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
<link rel="alternate" type="application/atom+xml" title="Nexus RP: Wiki Atom feed" index.html?title=Special:RecentChanges&amp;feed=atom" />		<title>Debugging - Nexus RP: Wiki</title>
		<link rel="stylesheet" href="/load.php?debug=false&amp;lang=en&amp;modules=ext.rtlcite%7Cmediawiki.legacy.commonPrint%2Cshared&amp;only=styles&amp;skin=nrpbook&amp;*" />
<link rel="stylesheet" href="../skins/nrpbook/main11b9.css?303" media="screen" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/nrpbook/IE50Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/nrpbook/IE55Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/skins/nrpbook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/nrpbook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=nrpbook&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: nrp_wiki_1_22_13-wiki_dev_:resourceloader:filter:minify-css:7:68ffccca97fd0532df6141dcbaf256b6 */</style>

		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?303"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Debugging","wgTitle":"Debugging","wgCurRevisionId":44818,"wgRevisionId":44818,"wgArticleId":2774,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Scripting Concepts","Tutorials"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransforNRPble":["",""],"wgDigitTransforNRPble":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Debugging","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script>
		<script type="text/javascript" src="../skins/common/wikibits11b9.js?303"><!-- wikibits js --></script>
		<!-- Head Scripts -->
<script src="/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=nrpbook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Debugging","wgTitle":"Debugging","wgCurRevisionId":44818,"wgRevisionId":44818,"wgArticleId":2774,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Scripting Concepts","Tutorials"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransforNRPble":["",""],"wgDigitTransforNRPble":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Debugging","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"nrpbook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"vector-simplesearch":1,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,
"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs100":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: nrp_wiki_1_22_13-wiki_dev_:resourceloader:filter:minify-js:7:925126ceab977200cdcc48193642dea0 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script><style type="text/css">/*<![CDATA[*/
.source-lua {line-height: normal;}
.source-lua li, .source-lua pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for lua
 * CSS class: source-lua, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.lua.source-lua .de1, .lua.source-lua .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.lua.source-lua  {font-family:monospace;}
.lua.source-lua .imp {font-weight: bold; color: red;}
.lua.source-lua li, .lua.source-lua .li1 {font-weight: normal; vertical-align:top;}
.lua.source-lua .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.lua.source-lua .li2 {font-weight: bold; vertical-align:top;}
.lua.source-lua .kw1 {color: #b1b100;}
.lua.source-lua .co1 {color: #808080; font-style: italic;}
.lua.source-lua .coMULTI {color: #808080; font-style: italic;}
.lua.source-lua .es0 {color: #000099; font-weight: bold;}
.lua.source-lua .br0 {color: #66cc66;}
.lua.source-lua .sy0 {color: #66cc66;}
.lua.source-lua .st0 {color: #00A600;}
.lua.source-lua .nu0 {color: #cc66cc;}
.lua.source-lua .me0 {color: #b1b100;}
.lua.source-lua .ln-xtra, .lua.source-lua li.ln-xtra, .lua.source-lua div.ln-xtra {background-color: #ffc;}
.lua.source-lua span.xtra { display:block; }

/*]]>*/
</style>	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Debugging skin-nrpbook">
	<div id="globalWrapper">
		
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
			<h1 id="firstHeading" class="firstHeading">Debugging</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Nexus RP: Wiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>		<!-- start content -->
<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>When scripting you will often come across problems that are not immediately apparent. This page tries to point out some basic strategies to locate the error.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Debug_console"><span class="tocnumber">1</span> <span class="toctext">Debug console</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Example"><span class="tocnumber">1.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Server_.26_client_debug_logging"><span class="tocnumber">2</span> <span class="toctext">Server &amp; client debug logging</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Server"><span class="tocnumber">2.1</span> <span class="toctext">Server</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Client"><span class="tocnumber">2.2</span> <span class="toctext">Client</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Debug_strategies"><span class="tocnumber">3</span> <span class="toctext">Debug strategies</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Useful_functions"><span class="tocnumber">3.1</span> <span class="toctext">Useful functions</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Add_debugmessages_to_check_if.2C_when_or_how_often_a_section_of_code_is_executed"><span class="tocnumber">3.2</span> <span class="toctext">Add debugmessages to check <i>if</i>, <i>when</i> or <i>how often</i> a section of code is executed</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Add_debugmessages_to_check_the_value_of_a_variable"><span class="tocnumber">3.3</span> <span class="toctext">Add debugmessages to check the <i>value</i> of a variable</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Example_2"><span class="tocnumber">4</span> <span class="toctext">Example</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#A_more_inconspicuous_error"><span class="tocnumber">4.1</span> <span class="toctext">A more inconspicuous error</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Debugging_Performance_Issues"><span class="tocnumber">5</span> <span class="toctext">Debugging Performance Issues</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Examples_of_scripts_that_could_cause_performance_problems"><span class="tocnumber">5.1</span> <span class="toctext">Examples of scripts that could cause performance problems</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Debug_console">Debug console</span></h2>
<p>NRP features a built-in debug console that shows debug messages output from NRP functions or from scripts. Keeping it mind that you should have administrator access (unless you modify the ACL to change this), you can open the debug console by typing <i>debugscript *x*</i> in the console, where <i>x</i> is the debug level:
</p>
<ul>
<li> <b>1:</b> only errors
</li>
<li> <b>2:</b> errors and warnings
</li>
<li> <b>3:</b> errors, warnings and info messages
</li>
</ul>
<p>By typing <i>debugscript 3</i> all messages are visible. Level 3 and level 2 are recommended for most occasions. You should have <i>debugscript</i> enabled whenever you are testing your scripts as it will help you easily detect and solve typos and other issues.
</p>
<h3><span class="mw-headline" id="Example">Example</span></h3>
<p>This example code has two errors:
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function SayHello(message, player) if (getPlayerName(player) == "Fedor") outputChatbox("Hello Fedor") end end addEventHandler("onChatMessage", root, SayHello)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> SayHello<span class="br0">&#40;</span>message, <a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><a href="GetPlayerName.html" class="kw2"><span class="kw2">getPlayerName</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="st0">&quot;Fedor&quot;</span><span class="br0">&#41;</span>
        outputChatbox<span class="br0">&#40;</span><span class="st0">&quot;Hello Fedor&quot;</span><span class="br0">&#41;</span>
    <span class="kw1">end</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onChatMessage&quot;</span>, root, SayHello<span class="br0">&#41;</span></pre></div></div>
<p>When the script this piece of code is in is tried to be loaded, debugscript will output something similiar to this:
</p>
<dl>
<dd><div style="color:#009900;padding:2px;">INFO: Loading script failed: myResource\script.lua:2: 'then' expected near ´outputChatbox'</div>
</dd>
</dl>
<p>This means the script could not be parsed because there was a syntax error. It shows the script path relative to the resource directory so you can identify to script where the error originated from. After the filename it shows a colon and a number, this number presents the line number - this is so you can find out where in your script the error is - it is very helpful for large scripts. After that is the error message, which varies depending on the error made. Looking at the error message, we can easily determine that the error originated from the resource <b>myResource</b> and line two of the script file <b>script.lua</b>. The error message is very clear, we forgot the "then"! We can easily fix that!
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function SayHello(message, player) if (getPlayerName(player) == "Fedor") then outputChatbox("Hello Fedor") end end addEventHandler("onChatMessage", root, SayHello)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> SayHello<span class="br0">&#40;</span>message, <a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><a href="GetPlayerName.html" class="kw2"><span class="kw2">getPlayerName</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="st0">&quot;Fedor&quot;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
        outputChatbox<span class="br0">&#40;</span><span class="st0">&quot;Hello Fedor&quot;</span><span class="br0">&#41;</span>
    <span class="kw1">end</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onChatMessage&quot;</span>, root, SayHello<span class="br0">&#41;</span></pre></div></div>
<p>Now the script will load fine and won't output any errors until a player with the name 'Fedor' says something in the chat. At that moment, the debug console will output:
</p>
<dl>
<dd><div style="color:#FF0000;padding:2px;">ERROR: myResource\script.lua:2: attempt to call global 'outputChatbox' (a nil value)</div>
</dd>
</dl>
<p>This error means that the function <b>outputChatbox</b> is a nil value, that is - it doesn't exist! This is because the function is actually called <a href="OutputChatBox.html" title="OutputChatBox">outputChatBox</a>, not <a index.html?title=OutputChatbox&amp;action=edit&amp;redlink=1" class="new" title="OutputChatbox (page does not exist)">outputChatbox</a> - take care of that capital B.:
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function SayHello(message, player) if (getPlayerName(player) == "Fedor") then outputChatBox("Hello Fedor") end end addEventHandler("onChatMessage", root, SayHello)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> SayHello<span class="br0">&#40;</span>message, <a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><a href="GetPlayerName.html" class="kw2"><span class="kw2">getPlayerName</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="st0">&quot;Fedor&quot;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
        <a href="OutputChatBox.html" class="kw6"><span class="kw6">outputChatBox</span></a><span class="br0">&#40;</span><span class="st0">&quot;Hello Fedor&quot;</span><span class="br0">&#41;</span>
    <span class="kw1">end</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onChatMessage&quot;</span>, root, SayHello<span class="br0">&#41;</span></pre></div></div>
<p>Of course, this is just an example and I've only skimmed the surface of error messages. There are plenty of other messages and scenarios, but you should get the general idea.
</p>
<h2><span class="mw-headline" id="Server_.26_client_debug_logging">Server &amp; client debug logging</span></h2>
<h4><span class="mw-headline" id="Server">Server</span></h4>
<p>Navigate to: <i>(NRP root folder)&gt;server&gt;mods&gt;deathmatch</i>
</p><p>There are two nearly identical files:
</p>
<ul>
<li>The local.conf is the settings for the "host game" menu item in the main menu of NRP. This is a quick and easy way of starting a temporary server from inside the client. When the client is turned off the server will also turn off.
</li>
</ul>
<ul>
<li>The nrpserver.conf is used when "NRP Server.exe" is executed from (NRP root folder)&gt;server. This runs the server in its own console window which does not need the client to exist or to be run. This is can be useful if you're interested in hosting servers for a longer time period or if you want to experiment with a real world console.
</li>
</ul>
<p>Depending on which way you host, you will want to edit those files. The settings in question are:
</p>
<!-- PLAIN TEXT CODE FOR BOTS |<! <scriptdebuglogfile>logs/scripts.log</scriptdebuglogfile> <! <scriptdebugloglevel>0</scriptdebugloglevel>|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="sy0">&lt;!</span><span class="co1">-- Specifies the location and name of the debugscript log file. If left blank, server won't be saving this file. --&gt;</span>
	<span class="sy0">&lt;</span>scriptdebuglogfile<span class="sy0">&gt;</span>logs<span class="sy0">/</span>scripts.log<span class="sy0">&lt;/</span>scriptdebuglogfile<span class="sy0">&gt;</span> 
&#160;
	<span class="sy0">&lt;!</span><span class="co1">-- Specifies the level of the debugscript log file. Available values: 0, 1, 2, 3. When not set, defaults to 0. --&gt;</span>
	<span class="sy0">&lt;</span>scriptdebugloglevel<span class="sy0">&gt;</span><span class="nu0">0</span><span class="sy0">&lt;/</span>scriptdebugloglevel<span class="sy0">&gt;</span></pre></div></div>
<p>You want to make sure you have a log name specified. Also you want to specify what level of errors will be logged. If it is 0 nothing will be logged. The levels were explained at the top of this article. If the logging level was changed to 3, then in this case all <b>serverside</b> script errors log to (NRP root folder)&gt;server&gt;mods&gt;deathmatch&gt;logs&gt;scripts.log
</p>
<h4><span class="mw-headline" id="Client">Client</span></h4>
<p>Navigate to: <i>(NRP root folder)&gt;server&gt;clientscript.log</i>
</p><p>This file logs all <b>clientside</b> script errors. This is set to log by default, no setup required.
</p>
<h2><span class="mw-headline" id="Debug_strategies">Debug strategies</span></h2>
<p>There are several strategies that support finding errors, apart from going through the code. Most of them include outputting debug messages, with have different information depending on the situtation.
</p>
<h3><span class="mw-headline" id="Useful_functions">Useful functions</span></h3>
<p>There are some functions that may come in handy for debugging.
</p>
<ul>
<li> <a href="OutputDebugString.html" title="OutputDebugString">outputDebugString</a> or <a href="OutputChatBox.html" title="OutputChatBox">outputChatBox</a> for outputting any information (use outputDebugString for technical output)
</li>
<li> <a rel="nofollow" class="external text" href="http://www.lua.org/manual/5.1/manual.html#pdf-tostring">tostring()</a> on a variable to turn the value into a string. Useful if the value is not a number or string.
</li>
<li> <a href="GetElementType.html" title="GetElementType">getElementType</a> to check the type of the NRP element.
</li>
<li> <a href="IsElement.html" title="IsElement">isElement</a> to check if the NRP element exists.
</li>
</ul>
<h3><span class="mw-headline" id="Add_debugmessages_to_check_if.2C_when_or_how_often_a_section_of_code_is_executed">Add debugmessages to check <i>if</i>, <i>when</i> or <i>how often</i> a section of code is executed</span></h3>
<p>A typical example would be verify whether an <i>if</i>-section is executed or not. To do that, just add any message you will recognize later within the <i>if</i>-section.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |if (variable1 == variable2) then outputDebugString("variable1 is the same as variable2!") end|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">if</span> <span class="br0">&#40;</span>variable1 <span class="sy0">==</span> variable2<span class="br0">&#41;</span> <span class="kw1">then</span>
    <a href="OutputDebugString.html" class="kw6"><span class="kw6">outputDebugString</span></a><span class="br0">&#40;</span><span class="st0">&quot;variable1 is the same as variable2!&quot;</span><span class="br0">&#41;</span>
    <span class="co1">-- do anything</span>
<span class="kw1">end</span></pre></div></div>
<p>Another application would be to check when variable values are modified. First search for all occurences of the variable being edited and add a message just beside it.
</p>
<h3><span class="mw-headline" id="Add_debugmessages_to_check_the_value_of_a_variable">Add debugmessages to check the <i>value</i> of a variable</span></h3>
<p>Let's say you want to create a marker, but it doesn't appear at the position you expect it to be. The first thing you might want to do is check if the <a href="CreateMarker.html" title="CreateMarker">createMarker</a> function is executed. But while doing this, you can also check the values being used in the <a href="CreateMarker.html" title="CreateMarker">createMarker</a> function in one run.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |outputChatBox("posX is: "..x.." posY is: "..y.." posZ is: "..z) createMarker(x,y,z)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><a href="OutputChatBox.html" class="kw6"><span class="kw6">outputChatBox</span></a><span class="br0">&#40;</span><span class="st0">&quot;posX is: &quot;</span>..x..<span class="st0">&quot; posY is: &quot;</span>..y..<span class="st0">&quot; posZ is: &quot;</span>..z<span class="br0">&#41;</span>
<a href="CreateMarker.html" class="kw2"><span class="kw2">createMarker</span></a><span class="br0">&#40;</span>x,y,z<span class="br0">&#41;</span></pre></div></div>
<p>This would output all three variables that are used as coordinates for the marker. Assuming you read those from a map file, you can now compare the debug output to the desired values. The <a rel="nofollow" class="external text" href="http://www.lua.org/manual/5.1/manual.html#pdf-tostring">tostring()</a> will ensure that the values of the variables can be concatenated (put together) as a string, even if it's a boolean value.
</p>
<h2><span class="mw-headline" id="Example_2">Example</span></h2>
<p>Imagine you created a <a href="Colshape.html" title="Colshape" class="mw-redirect">collision shape</a> somewhere and you want an action to perform after the player stays for ten seconds inside it, you would do this:
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function colShapeHit(player) colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!") end addEventHandler("onColShapeHit", root, colShapeHit) function colShapeLeave(player) killTimer(colshapeTimer[player]) end addEventHandler("onColShapeLeave", root, colShapeLeave)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> colShapeHit<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="co1">-- set a timer to output a message (could as well execute another function)</span>
	<span class="co1">-- store the timer id in a table, using the player as index</span>
	colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span> <span class="sy0">=</span> <a href="SetTimer.html" class="kw2"><span class="kw2">setTimer</span></a><span class="br0">&#40;</span><a href="OutputChatBox.html" class="kw6"><span class="kw6">outputChatBox</span></a>,<span class="nu0">10000</span>,<span class="nu0">1</span>,<span class="st0">&quot;The player stayed 10 seconds in the colshape!&quot;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeHit&quot;</span>, root, colShapeHit<span class="br0">&#41;</span>
&#160;
<span class="kw1">function</span> colShapeLeave<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="co1">-- kill the timer when the player leaves the colshape</span>
	<a href="KillTimer.html" class="kw2"><span class="kw2">killTimer</span></a><span class="br0">&#40;</span>colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeLeave&quot;</span>, root, colShapeLeave<span class="br0">&#41;</span></pre></div></div>
<p>When a player enters the colshape, debugscript outputs the following message:
</p>
<dl>
<dd><div style="color:#FF0000;padding:2px;">ERROR: ..[path]: attempt to index global 'colshapeTimer' (a nil value)</div>
</dd>
</dl>
<p>This means you tried to index a table that does not exist (because the table is a nil value, it doesn't exist). In the example above, this is done when storing the timer id in the table. We need to add a check if the table exists and if it does not exist we should create it.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function colShapeHit(player) if (colshapeTimer == nil) then colshapeTimer = {} end colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!") end addEventHandler("onColShapeHit", root, colShapeHit) function colShapeLeave(player) killTimer(colshapeTimer[player]) end addEventHandler("onColShapeLeave",root,colShapeLeave)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> colShapeHit<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>colshapeTimer <span class="sy0">==</span> <span class="kw1">nil</span><span class="br0">&#41;</span> <span class="kw1">then</span>
		colshapeTimer <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span>
	<span class="kw1">end</span>
	<span class="co1">-- set a timer to output a message (could as well execute another function)</span>
	<span class="co1">-- store the timer id in a table, using the player as index</span>
	colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span> <span class="sy0">=</span> <a href="SetTimer.html" class="kw2"><span class="kw2">setTimer</span></a><span class="br0">&#40;</span><a href="OutputChatBox.html" class="kw6"><span class="kw6">outputChatBox</span></a>,<span class="nu0">10000</span>,<span class="nu0">1</span>,<span class="st0">&quot;The player stayed 10 seconds in the colshape!&quot;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeHit&quot;</span>, root, colShapeHit<span class="br0">&#41;</span>
&#160;
<span class="kw1">function</span> colShapeLeave<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="co1">-- kill the timer when the player leaves the colshape</span>
	<a href="KillTimer.html" class="kw2"><span class="kw2">killTimer</span></a><span class="br0">&#40;</span>colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeLeave&quot;</span>,root,colShapeLeave<span class="br0">&#41;</span></pre></div></div>
<p>Now we will still receive a warning when a player enters the colshape, waits for the message and leaves it again:
</p>
<dl>
<dd><div style="color:#00FF00;padding:2px;">WARNING: [..]: Bad argument @ 'killTimer' Line: ..</div>
</dd>
</dl>
<p>Except for that (we will talk about that later) everything seems to work fine. A player enters the colshape, the timer is started, if he stays the message occurs, if he leaves the timer is killed.
</p>
<h3><span class="mw-headline" id="A_more_inconspicuous_error">A more inconspicuous error</span></h3>
<p>But for some reason the message gets outputted twice when you stay in the colcircle while in a vehicle. Since it would appear some code is executed twice, we add debug messages to check this.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function colShapeHit(player) if (colshapeTimer == nil) then colshapeTimer = {} end outputDebugString("colShapeHit") colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!") end addEventHandler("onColShapeHit",getRootElement(),colShapeHit) function colShapeLeave(player) outputDebugString("colShapeLeave") killTimer(colshapeTimer[player]) end addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> colShapeHit<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>colshapeTimer <span class="sy0">==</span> <span class="kw1">nil</span><span class="br0">&#41;</span> <span class="kw1">then</span>
		colshapeTimer <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span>
	<span class="kw1">end</span>
	<span class="co1">-- add a debug message</span>
	<a href="OutputDebugString.html" class="kw6"><span class="kw6">outputDebugString</span></a><span class="br0">&#40;</span><span class="st0">&quot;colShapeHit&quot;</span><span class="br0">&#41;</span>
	<span class="co1">-- set a timer to output a message (could as well execute another function)</span>
	<span class="co1">-- store the timer id in a table, using the player as index</span>
	colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span> <span class="sy0">=</span> <a href="SetTimer.html" class="kw2"><span class="kw2">setTimer</span></a><span class="br0">&#40;</span><a href="OutputChatBox.html" class="kw6"><span class="kw6">outputChatBox</span></a>,<span class="nu0">10000</span>,<span class="nu0">1</span>,<span class="st0">&quot;The player stayed 10 seconds in the colshape!&quot;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeHit&quot;</span>,<a href="GetRootElement.html" class="kw2"><span class="kw2">getRootElement</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>,colShapeHit<span class="br0">&#41;</span>
&#160;
<span class="kw1">function</span> colShapeLeave<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="co1">-- add a debug message</span>
	<a href="OutputDebugString.html" class="kw6"><span class="kw6">outputDebugString</span></a><span class="br0">&#40;</span><span class="st0">&quot;colShapeLeave&quot;</span><span class="br0">&#41;</span>
	<span class="co1">-- kill the timer when the player leaves the colshape</span>
	<a href="KillTimer.html" class="kw2"><span class="kw2">killTimer</span></a><span class="br0">&#40;</span>colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeLeave&quot;</span>,<a href="GetRootElement.html" class="kw2"><span class="kw2">getRootElement</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>,colShapeLeave<span class="br0">&#41;</span></pre></div></div>
<p>Now we notice that both handler functions get executed twice when we are in a vehicle, but only once when we are on-foot. It would appear the vehicle triggers the colshape as well. To confirm this theory, we ensure that the <i>player</i> variable actually holds a reference to a player element.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function colShapeHit(player) if (colshapeTimer == nil) then colshapeTimer = {} end outputDebugString("colShapeHit "..getElementType(player)) colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!") end addEventHandler("onColShapeHit",getRootElement(),colShapeHit) function colShapeLeave(player) outputDebugString("colShapeLeave "..getElementType(player)) killTimer(colshapeTimer[player]) end addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> colShapeHit<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>colshapeTimer <span class="sy0">==</span> <span class="kw1">nil</span><span class="br0">&#41;</span> <span class="kw1">then</span>
		colshapeTimer <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span>
	<span class="kw1">end</span>
	<span class="co1">-- add a debug message, with the element type</span>
	<a href="OutputDebugString.html" class="kw6"><span class="kw6">outputDebugString</span></a><span class="br0">&#40;</span><span class="st0">&quot;colShapeHit &quot;</span>..<a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="co1">-- set a timer to output a message (could as well execute another function)</span>
	<span class="co1">-- store the timer id in a table, using the player as index</span>
	colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span> <span class="sy0">=</span> <a href="SetTimer.html" class="kw2"><span class="kw2">setTimer</span></a><span class="br0">&#40;</span><a href="OutputChatBox.html" class="kw6"><span class="kw6">outputChatBox</span></a>,<span class="nu0">10000</span>,<span class="nu0">1</span>,<span class="st0">&quot;The player stayed 10 seconds in the colshape!&quot;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeHit&quot;</span>,<a href="GetRootElement.html" class="kw2"><span class="kw2">getRootElement</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>,colShapeHit<span class="br0">&#41;</span>
&#160;
<span class="kw1">function</span> colShapeLeave<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="co1">-- add a debug message, with the element type</span>
	<a href="OutputDebugString.html" class="kw6"><span class="kw6">outputDebugString</span></a><span class="br0">&#40;</span><span class="st0">&quot;colShapeLeave &quot;</span>..<a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="co1">-- kill the timer when the player leaves the colshape</span>
	<a href="KillTimer.html" class="kw2"><span class="kw2">killTimer</span></a><span class="br0">&#40;</span>colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeLeave&quot;</span>,<a href="GetRootElement.html" class="kw2"><span class="kw2">getRootElement</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>,colShapeLeave<span class="br0">&#41;</span></pre></div></div>
<p>The debug messages tell us that one of the <i>player</i> variables is a player and that the other one is a vehicle element. Since we only want to react when a player enters the colshape, we add an <i>if</i> that will end the execution of the function if it's <b>not</b> an player element.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function colShapeHit(player) if (colshapeTimer == nil) then colshapeTimer = {} end if (getElementType(player) ~= "player") then return end outputDebugString("colShapeHit "..getElementType(player)) colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!") end addEventHandler("onColShapeHit",getRootElement(),colShapeHit) function colShapeLeave(player) if (getElementType(player) ~= "player") then return end outputDebugString("colShapeLeave "..getElementType(player)) killTimer(colshapeTimer[player]) end addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> colShapeHit<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>colshapeTimer <span class="sy0">==</span> <span class="kw1">nil</span><span class="br0">&#41;</span> <span class="kw1">then</span>
		colshapeTimer <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span>
	<span class="kw1">end</span>
	<span class="co1">-- add a check for the element type</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span><a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span> ~<span class="sy0">=</span> <span class="st0">&quot;player&quot;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">return</span> <span class="kw1">end</span>
	<span class="co1">-- add a debug message, with the element type</span>
	<a href="OutputDebugString.html" class="kw6"><span class="kw6">outputDebugString</span></a><span class="br0">&#40;</span><span class="st0">&quot;colShapeHit &quot;</span>..<a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="co1">-- set a timer to output a message (could as well execute another function)</span>
	<span class="co1">-- store the timer id in a table, using the player as index</span>
	colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span> <span class="sy0">=</span> <a href="SetTimer.html" class="kw2"><span class="kw2">setTimer</span></a><span class="br0">&#40;</span><a href="OutputChatBox.html" class="kw6"><span class="kw6">outputChatBox</span></a>,<span class="nu0">10000</span>,<span class="nu0">1</span>,<span class="st0">&quot;The player stayed 10 seconds in the colshape!&quot;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeHit&quot;</span>,<a href="GetRootElement.html" class="kw2"><span class="kw2">getRootElement</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>,colShapeHit<span class="br0">&#41;</span>
&#160;
<span class="kw1">function</span> colShapeLeave<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="co1">-- add a check for the element type</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span><a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span> ~<span class="sy0">=</span> <span class="st0">&quot;player&quot;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">return</span> <span class="kw1">end</span>
	<span class="co1">-- add a debug message, with the element type</span>
	<a href="OutputDebugString.html" class="kw6"><span class="kw6">outputDebugString</span></a><span class="br0">&#40;</span><span class="st0">&quot;colShapeLeave &quot;</span>..<a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="co1">-- kill the timer when the player leaves the colshape</span>
	<a href="KillTimer.html" class="kw2"><span class="kw2">killTimer</span></a><span class="br0">&#40;</span>colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeLeave&quot;</span>,<a href="GetRootElement.html" class="kw2"><span class="kw2">getRootElement</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>,colShapeLeave<span class="br0">&#41;</span></pre></div></div>
<p>Now the script should work as desired, but it will still output the warning mentioned above. This happens because the timer we try to kill when a player leaves the colshape will not exist anymore when it has reached the 10 seconds (and therefore executed after the 10th second has completed). There are different ways to get rid of that warning (since you know that the timer might not exist anymore and you only want to kill it if it exists). One way would be to check if the timer referenced in the table really exists. To do this, we need to use <a href="IsTimer.html" title="IsTimer">isTimer</a>, which we will use when we kill the timer:
</p>
<!-- PLAIN TEXT CODE FOR BOTS |if (isTimer(colshapeTimer[player])) then killTimer(colshapeTimer[player]) end|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">if</span> <span class="br0">&#40;</span><a href="IsTimer.html" class="kw2"><span class="kw2">isTimer</span></a><span class="br0">&#40;</span>colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
	<a href="KillTimer.html" class="kw2"><span class="kw2">killTimer</span></a><span class="br0">&#40;</span>colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">end</span></pre></div></div>
<p>So the complete working code would be:
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function colShapeHit(player) if (colshapeTimer == nil) then colshapeTimer = {} end if (getElementType(player) ~= "player") then return end outputDebugString("colShapeHit "..getElementType(player)) colshapeTimer[player] = setTimer(outputChatBox,10000,1,"The player stayed 10 seconds in the colshape!") end addEventHandler("onColShapeHit",getRootElement(),colShapeHit) function colShapeLeave(player) if (getElementType(player) ~= "player") then return end outputDebugString("colShapeLeave "..getElementType(player)) if (isTimer(colshapeTimer[player])) then killTimer(colshapeTimer[player]) end end addEventHandler("onColShapeLeave",getRootElement(),colShapeLeave)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> colShapeHit<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>colshapeTimer <span class="sy0">==</span> <span class="kw1">nil</span><span class="br0">&#41;</span> <span class="kw1">then</span>
		colshapeTimer <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span>
	<span class="kw1">end</span>
	<span class="co1">-- add a check for the element type</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span><a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span> ~<span class="sy0">=</span> <span class="st0">&quot;player&quot;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">return</span> <span class="kw1">end</span>
	<span class="co1">-- add a debug message, with the element type</span>
	<a href="OutputDebugString.html" class="kw6"><span class="kw6">outputDebugString</span></a><span class="br0">&#40;</span><span class="st0">&quot;colShapeHit &quot;</span>..<a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="co1">-- set a timer to output a message (could as well execute another function)</span>
	<span class="co1">-- store the timer id in a table, using the player as index</span>
	colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span> <span class="sy0">=</span> <a href="SetTimer.html" class="kw2"><span class="kw2">setTimer</span></a><span class="br0">&#40;</span><a href="OutputChatBox.html" class="kw6"><span class="kw6">outputChatBox</span></a>,<span class="nu0">10000</span>,<span class="nu0">1</span>,<span class="st0">&quot;The player stayed 10 seconds in the colshape!&quot;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeHit&quot;</span>,<a href="GetRootElement.html" class="kw2"><span class="kw2">getRootElement</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>,colShapeHit<span class="br0">&#41;</span>
&#160;
<span class="kw1">function</span> colShapeLeave<span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span>
	<span class="co1">-- add a check for the element type</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span><a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span> ~<span class="sy0">=</span> <span class="st0">&quot;player&quot;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">return</span> <span class="kw1">end</span>
	<span class="co1">-- add a debug message, with the element type</span>
	<a href="OutputDebugString.html" class="kw6"><span class="kw6">outputDebugString</span></a><span class="br0">&#40;</span><span class="st0">&quot;colShapeLeave &quot;</span>..<a href="GetElementType.html" class="kw2"><span class="kw2">getElementType</span></a><span class="br0">&#40;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="co1">-- kill the timer when the player leaves the colshape</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span><a href="IsTimer.html" class="kw2"><span class="kw2">isTimer</span></a><span class="br0">&#40;</span>colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
		<a href="KillTimer.html" class="kw2"><span class="kw2">killTimer</span></a><span class="br0">&#40;</span>colshapeTimer<span class="br0">&#91;</span><a href="Player.html" class="kw3"><span class="kw3">player</span></a><span class="br0">&#93;</span><span class="br0">&#41;</span>
	<span class="kw1">end</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onColShapeLeave&quot;</span>,<a href="GetRootElement.html" class="kw2"><span class="kw2">getRootElement</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>,colShapeLeave<span class="br0">&#41;</span></pre></div></div>
<p><br />
</p>
<h2><span class="mw-headline" id="Debugging_Performance_Issues">Debugging Performance Issues</span></h2>
<p>If your server is using up more resources than it should or you just want to make sure your scripts are efficient, you can find the source of the issue by using a great tool that comes with the default resource package called <a href="Resource_Performancebrowser.html" title="Resource:Performancebrowser">performancebrowser</a>. You can start it with '<b>start performancebrowser'</b>. If it doesn't exist then you can get the latest resources from the <a rel="nofollow" class="external text" href="https://github.com/nexusrp/nrpsa-resources">GitHub repository</a>. This tool provides an incredible amount of information for performance debugging. Memory leaks, element leaks and CPU intensive scripts are all easily findable via performancebrowser. If you use the '<b>d'</b> option in Lua timing you can see which functions are using up the CPU.
</p><p>To access performancebrowser you will need to go to your web browser and enter the address: <a rel="nofollow" class="external free" href="http://serveriphere:serverhttpporthere/performancebrowser/">http://serverIPHere:serverHTTPPortHere/performancebrowser/</a> Note that the / at the end is required. So for example: <a rel="nofollow" class="external free" href="http://127.0.0.1:22005/performancebrowser/">http://127.0.0.1:22005/performancebrowser/</a> You will then need to login with an in-game admin account or any account that has access to '<b>resource.performancebrowser.http'</b> and '<b>resource.ajax.http'</b>. Most of the information you will need are in the categories Lua timing and Lua memory, look for values that are much higher than other values.
</p>
<h3><span class="mw-headline" id="Examples_of_scripts_that_could_cause_performance_problems">Examples of scripts that could cause performance problems</span></h3>
<p>Adding data to a table but never removing it. This would take months/years before it causes a problem though.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |local someData = {} function storeData() someData[source] = true end addEventHandler("onPlayerJoin", root, storeData)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">local</span> someData <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span>
&#160;
<span class="kw1">function</span> storeData<span class="br0">&#40;</span><span class="br0">&#41;</span>
    someData<span class="br0">&#91;</span>source<span class="br0">&#93;</span> <span class="sy0">=</span> <span class="kw1">true</span>
    <span class="co1">-- There is no handling for when a player quits, this is considered a memory leak</span>
    <span class="co1">-- Using the Lua timing tab you can detect the RAM usage of each resource.</span>
<span class="kw1">end</span>
<a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onPlayerJoin&quot;</span>, root, storeData<span class="br0">&#41;</span></pre></div></div>
<p>Element leaking is possible if you use temporary colshapes for whatever reason and may not destroy them. This would cause bandwidth, CPU and memory performance issues over time.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function useTemporaryCol() local col = createColCircle(some code here) if (normally this should happen) then destroyElement(col) end end|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> useTemporaryCol<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="kw1">local</span> col <span class="sy0">=</span> <a href="CreateColCircle.html" class="kw2"><span class="kw2">createColCircle</span></a><span class="br0">&#40;</span>some code here<span class="br0">&#41;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>normally this should happen<span class="br0">&#41;</span> <span class="kw1">then</span>
        <a href="DestroyElement.html" class="kw2"><span class="kw2">destroyElement</span></a><span class="br0">&#40;</span>col<span class="br0">&#41;</span>
    <span class="kw1">end</span>
    <span class="co1">-- But sometimes it didn't so the script ended but the collision area remained and over time</span>
    <span class="co1">-- you may end up with hundreds to thousands of pointless collision areas. </span>
    <span class="co1">-- The Lua timing tab allows you to see the amount of elements each script has created.</span>
<span class="kw1">end</span></pre></div></div>
<p>High CPU usage resulting in the server FPS dropping so much that the server is unplayable. In under 24 hours this can create havoc on a very busy server. The amount of "refs" in the Lua timing detect this type of build up, surprisingly the Lua timing tab didn't help in this case but Lua memory did.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |addEventHandler("onPlayerJoin", root, function() addEventHandler("onPlayerQuit", root, function() end) end)|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onPlayerJoin&quot;</span>, root, <span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="co1">-- Code for joiner</span>
    <a href="AddEventHandler.html" class="kw2"><span class="kw2">addEventHandler</span></a><span class="br0">&#40;</span><span class="st0">&quot;onPlayerQuit&quot;</span>, root, <span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="co1">-- Code for when they have quit</span>
        <span class="co1">-- See the problem? It's bound to root which the event handler is being added again and again and again</span>
    <span class="kw1">end</span><span class="br0">&#41;</span>
<span class="kw1">end</span><span class="br0">&#41;</span></pre></div></div>
<p>A function uses up a lot of your CPU because whatever it does takes a long time. This is just some function that takes a long time to complete. Without performancebrowser you'd have no idea its the cause but with performancebrowser you can see that a resource is using lots of CPU in the Lua timing tab. If you then enter: '<b>d'</b> into the options edit box it will even tell you what file name and first line of the function that is using up so much CPU.
</p>
<!-- PLAIN TEXT CODE FOR BOTS |function someDodgyCode() for i=1, 100000 do end end|--><div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="lua source-lua"><pre class="de1"><span class="kw1">function</span> someDodgyCode<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="kw1">for</span> i<span class="sy0">=</span><span class="nu0">1</span>, <span class="nu0">100000</span> <span class="kw1">do</span>
        <span class="co1">-- some code</span>
    <span class="kw1">end</span>
<span class="kw1">end</span></pre></div></div>

<!-- 
NewPP limit report
CPU time usage: 0.449 seconds
Real time usage: 0.453 seconds
Preprocessor visited node count: 208/1000000
Preprocessor generated node count: 494/1000000
Post‐expand include size: 479/2097152 bytes
Template argument size: 266/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key nrp_wiki_1_22_13-wiki_dev_:pcache:idhash:2774-0!*!0!!en!*!* and timestamp 20150826121528
 -->
</div><div class="printfooter">
Retrieved from "<a index.html?title=Debugging&amp;oldid=44818">/index.php?title=Debugging&amp;oldid=44818</a>"</div>
		<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="Category_Scripting_Concepts.html" title="Category:Scripting Concepts">Scripting Concepts</a></li><li><a href="Category_Tutorials.html" title="Category:Tutorials">Tutorials</a></li></ul></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="Debugging.html"Array>Page</a></li>
				 <li id="ca-talk"><a href="Talk_Debugging.html"Array>Discussion</a></li>
				 <li id="ca-viewsource"><a index.html?title=Debugging&amp;action=edit"Array>View source</a></li>
				 <li id="ca-history"><a index.html?title=Debugging&amp;action=history"Array>History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a index.html?title=Special:UserLogin&amp;returnto=Debugging"Array></a></li>
			</ul>
		</div>
	</div>
	
	<div class="portlet" id="p-logo">
		<a style="background-image: url();" href="Main_Page.html"Array></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Home"><a href="Main_Page.html"Array>Home</a></li>
				<li id="n-How-you-can-help"><a href="How_you_can_help.html"Array>How you can help</a></li>
				<li id="n-recentchanges"><a href="Special_RecentChanges.html"Array>Recent changes</a></li>
				<li id="n-randompage"><a href="OnElementDataChange.html"Array>Random page</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-reference'>
		<h5>reference</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Client-Functions"><a href="Client_Scripting_Functions.html"Array>Client Functions</a></li>
				<li id="n-Client-Events"><a href="Client_Scripting_Events.html"Array>Client Events</a></li>
				<li id="n-Server-Functions"><a href="Server_Scripting_Functions.html"Array>Server Functions</a></li>
				<li id="n-Server-Events"><a href="Server_Scripting_Events.html"Array>Server Events</a></li>
				<li id="n-Useful-Functions"><a href="Useful_Functions.html"Array>Useful Functions</a></li>
				<li id="n-NRP-Classes"><a href="NRP_Classes.html"Array>NRP Classes</a></li>
				<li id="n-NRP-Elements"><a href="Element.html"Array>NRP Elements</a></li>
				<li id="n-Element-Tree"><a href="Element_tree.html"Array>Element Tree</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		
		<div id="searchBody" class="pBody">
			<form action="/index.php" id="searchform"><div>
				
				
				
				
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Tools</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Debugging.html"Array>What links here</a></li>
				<li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Debugging.html"Array>Related changes</a></li>
<li id="t-specialpages"><a href="Special_SpecialPages.html"Array>Special pages</a></li>
				<li id="t-print"><a index.html?title=Debugging&amp;printable=yes" rel="alternate"Array>Printable version</a></li>				<li id="t-permalink"><a index.html?title=Debugging&amp;oldid=44818"Array>Permanent link</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>In other languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-it"><a href="../wiki/IT/Guida_al_Debug">Italiano</a></li>
				<li class="interwiki-ru"><a href="../wiki/RU/Debugging">Русский</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" height="31" width="88" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://www.gnu.org/copyleft/fdl.html"><img src="../skins/common/images/gnu-fdl.png" alt="GNU Free Documentation License 1.2" width="88" height="31" /></a></div>
	<ul id="f-list">
					<li id="lastmod"> This page was last modified on 26 March 2015, at 14:57.</li>
					<li id="viewcount">This page has been accessed 65,681 times.</li>
					<li id="copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.2</a> unless otherwise noted.</li>
					<li id="privacy"><a href="Nexus_RP__Wiki_Privacy_policy.html" title="Nexus RP: Wiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="Nexus_RP__Wiki_About.html" title="Nexus RP: Wiki:About">About Nexus RP: Wiki</a></li>
					<li id="disclaimer"><a href="Nexus_RP__Wiki_General_disclaimer.html" title="Nexus RP: Wiki:General disclaimer">Disclaimers</a></li>
			</ul>
</div>
</div>
<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.cite"],null,true);
}</script>
<script src="/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=nrpbook&amp;*"></script>
<!-- Served in 0.047 secs. --></body>
<!-- Mirrored from wiki.nexusrp.com/wiki/Debugging by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 27 Aug 2015 07:28:26 GMT -->
</html>
